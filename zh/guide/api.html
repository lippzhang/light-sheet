<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API | FortuneSheet文档</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="FortuneSheet是一款开箱即用的类似Excel和Google Sheets的javascript表格组件。本站包含官方配置文档，API，教程。">
    
    <link rel="preload" href="/fortune-sheet-docs/assets/css/0.styles.456c1cbe.css" as="style"><link rel="preload" href="/fortune-sheet-docs/assets/js/app.74366edf.js" as="script"><link rel="preload" href="/fortune-sheet-docs/assets/js/2.173094f5.js" as="script"><link rel="preload" href="/fortune-sheet-docs/assets/js/1.c7831255.js" as="script"><link rel="preload" href="/fortune-sheet-docs/assets/js/34.2f924603.js" as="script"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/10.adac80ad.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/11.50d1fb22.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/12.cfcc6a1e.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/13.ccc02464.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/14.246cba84.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/15.55c9208d.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/16.35505d11.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/17.69ad532e.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/18.276e717c.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/19.bd5d586d.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/20.b0483b69.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/21.2750f0b2.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/22.62708e6b.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/23.9d8a6635.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/24.c5579021.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/25.88235f3c.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/26.a81b0b95.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/27.053f8621.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/28.a8437aaa.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/29.cfc5abbb.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/3.78bda124.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/30.5cad59e9.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/31.cc004cee.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/32.f16bb494.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/33.f86b1afc.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/35.545a11e2.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/36.be05224a.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/37.c20f816f.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/38.a3864a0f.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/39.68fee743.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/4.3e8182d7.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/5.f7a1187b.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/6.30ae4223.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/7.5c569193.js"><link rel="prefetch" href="/fortune-sheet-docs/assets/js/vendors~docsearch.663d6e13.js">
    <link rel="stylesheet" href="/fortune-sheet-docs/assets/css/0.styles.456c1cbe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fortune-sheet-docs/zh/" class="home-link router-link-active"><!----> <span class="site-name">FortuneSheet文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/fortune-sheet-docs/zh/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/fortune-sheet-docs/zh/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="https://ruilisi.github.io/fortune-sheet-demo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  演示
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="选择语言" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="选择语言" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fortune-sheet-docs/guide/api.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/fortune-sheet-docs/zh/guide/api.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/ruilisi/fortune-sheet" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/fortune-sheet-docs/zh/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/fortune-sheet-docs/zh/guide/" class="nav-link router-link-active">
  指南
</a></div><div class="nav-item"><a href="https://ruilisi.github.io/fortune-sheet-demo/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  演示
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="选择语言" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="选择语言" class="mobile-dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fortune-sheet-docs/guide/api.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/fortune-sheet-docs/zh/guide/api.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/ruilisi/fortune-sheet" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/fortune-sheet-docs/zh/guide/" aria-current="page" class="sidebar-link">快速上手</a></li><li><a href="/fortune-sheet-docs/zh/guide/config.html" class="sidebar-link">整体配置</a></li><li><a href="/fortune-sheet-docs/zh/guide/sheet.html" class="sidebar-link">工作表配置</a></li><li><a href="/fortune-sheet-docs/zh/guide/cell.html" class="sidebar-link">单元格</a></li><li><a href="/fortune-sheet-docs/zh/guide/op.html" class="sidebar-link">操作</a></li><li><a href="/fortune-sheet-docs/zh/guide/api.html" aria-current="page" class="active sidebar-link">API</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fortune-sheet-docs/zh/guide/api.html#概览" class="sidebar-link">概览</a></li></ul></li><li><a href="/fortune-sheet-docs/zh/guide/FAQ.html" class="sidebar-link">常见问题</a></li><li><a href="/fortune-sheet-docs/zh/guide/contribute.html" class="sidebar-link">贡献指南</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="api"><a href="#api" class="header-anchor">#</a> API</h1> <p>API 可通过 <code>Workbook</code> 的 <code>ref</code> 暴露出来.</p> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">const</span> ref <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useRef</span><span class="token generic class-name"><span class="token operator">&lt;</span>WorkbookInstance<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Workbook</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span></span> <span class="token attr-name">...</span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><h2 id="概览"><a href="#概览" class="header-anchor">#</a> 概览</h2> <table><thead><tr><th>API</th> <th>描述</th></tr></thead> <tbody><tr><td><a href="#applyop">applyOp</a></td> <td>在workbook上应用一组OP</td></tr> <tr><td><a href="#getcellvalue">getCellValue</a></td> <td>获取一个单元格的值</td></tr> <tr><td><a href="#setcellvalue">setCellValue</a></td> <td>设置一个单元格的值</td></tr> <tr><td><a href="#clearcell">clearCell</a></td> <td>清除一个单元格的内容</td></tr> <tr><td><a href="#setcellformat">setCellFormat</a></td> <td>设置单元格属性</td></tr> <tr><td><a href="#autofillcell">autoFillCell</a></td> <td>自动填充单元格</td></tr> <tr><td><a href="#freeze">freeze</a></td> <td>冻结行/列</td></tr> <tr><td><a href="#insertroworcolumn">insertRowOrColumn</a></td> <td>在指定位置插入行/列</td></tr> <tr><td><a href="#deleteroworcolumn">deleteRowOrColumn</a></td> <td>删除指定范围的行/列</td></tr> <tr><td><a href="#getrowheight">getRowHeight</a></td> <td>获取一批行高</td></tr> <tr><td><a href="#getcolumnwidth">getColumnWidth</a></td> <td>获取一批列宽</td></tr> <tr><td><a href="#setrowheight">setRowHeight</a></td> <td>设置一批行高</td></tr> <tr><td><a href="#setcolumnwidth">setColumnWidth</a></td> <td>设置一批列宽</td></tr> <tr><td><a href="#setselection">setSelection</a></td> <td>设置选取范围</td></tr> <tr><td><a href="#getflattenrange">getFlattenRange</a></td> <td>将给定范围转换成多个单元格坐标</td></tr> <tr><td><a href="#getcellsbyflattenrange">getCellsByFlattenRange</a></td> <td>将单元格坐标映射到单元格对象</td></tr> <tr><td><a href="#getselectioncoordinates">getSelectionCoordinates</a></td> <td>获取选择坐标的文本表示列表</td></tr> <tr><td><a href="#getcellsbyrange">getCellsByRange</a></td> <td>将范围映射到单元格对象</td></tr> <tr><td><a href="#gethtmlbyrange">getHtmlByRange</a></td> <td>获取指定范围的 html 形式内容</td></tr> <tr><td><a href="#mergecells">mergeCells</a></td> <td>根据范围和类型合并选区</td></tr> <tr><td><a href="#cancelmerge">cancelMerge</a></td> <td>取消一个合并区域</td></tr> <tr><td><a href="#getallsheets">getAllSheets</a></td> <td>获取所有表的原始数据</td></tr> <tr><td><a href="#getsheet">getSheet</a></td> <td>获得一张表的原始数据</td></tr> <tr><td><a href="#addsheet">addSheet</a></td> <td>新增一张表格</td></tr> <tr><td><a href="#deletesheet">deleteSheet</a></td> <td>删除指定表格</td></tr> <tr><td><a href="#updatesheet">updateSheet</a></td> <td>根据指定的数据更新表格</td></tr> <tr><td><a href="#activatesheet">activateSheet</a></td> <td>将指定表格设置为当前表</td></tr> <tr><td><a href="#setsheetname">setSheetName</a></td> <td>设置指定表的表名</td></tr> <tr><td><a href="#setsheetorder">setSheetOrder</a></td> <td>设置表格顺序</td></tr> <tr><td><a href="#scroll">scroll</a></td> <td>滑动到当前表的指定位置</td></tr> <tr><td><a href="#addpresence">addPresence</a></td> <td>添加协作者表现</td></tr> <tr><td><a href="#removepresence">removePresence</a></td> <td>删除协作者表现</td></tr> <tr><td><a href="#undo">undo</a></td> <td>撤销</td></tr> <tr><td><a href="#redo">redo</a></td> <td>重做</td></tr></tbody></table> <hr> <h3 id="commonoptions"><a href="#commonoptions" class="header-anchor">#</a> CommonOptions</h3> <p>许多API都有一个可选参数 <code>options</code> ，这主要是给用户选择表格时使用的</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>index</td> <td>number</td> <td>表格在整体中的序号</td></tr> <tr><td>id</td> <td>string</td> <td>表格的id，如果有index值，id就不会生效</td></tr></tbody></table> <hr> <h3 id="applyop"><a href="#applyop" class="header-anchor">#</a> applyOp</h3> <p><em>applyOp(ops)</em></p> <p>应用op至Workbook。</p> <p>通常用于在线协同场景，用来同步数据。</p> <p>更多可见 <a href="https://github.com/ruilisi/fortune-sheet/blob/master/stories/Collabration.stories.tsx" target="_blank" rel="noopener noreferrer">Collabration demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for an example usage.</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>ops</td> <td>Op[]</td> <td>当前操作的op列表</td></tr></tbody></table> <hr> <h3 id="getcellvalue"><a href="#getcellvalue" class="header-anchor">#</a> getCellValue</h3> <p><em>getCellValue(row, column, [options]) -&gt; any</em></p> <p>获取指定单元格的值</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>row</td> <td>number</td> <td>单元格所在行数；从0开始的整数，0表示第一行</td></tr> <tr><td>column</td> <td>number</td> <td>单元格所在列数；从0开始的整数，0表示第一列</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">可选参数</a> &amp; { type: string }</td> <td><code>type</code>: 单元格属性，默认是'v'</td></tr></tbody></table> <p><strong>Returns</strong> 指定的单元格属性，如果<code>options.type</code>没有被指定，则会返回单元格的<code>v</code>值。</p> <p>特殊情况，单元格格式为<code>yyyy-MM-dd</code>，<code>type</code>为<code>'v'</code>时会强制取<code>'m'</code>显示值。</p> <ul><li><p><strong>示例</strong>:</p> <ul><li><p>返回当前工作表第1行第1列单元格的数据的v值</p> <p><code>workboobRef.current.getCellValue(0, 0)</code></p></li> <li><p>返回指定data数据的第2行第2列单元格的显示值。</p> <p><code>workboobRef.current.getCellValue(1, 1, {type:&quot;m&quot;})</code></p></li></ul></li></ul> <hr> <h3 id="setcellvalue"><a href="#setcellvalue" class="header-anchor">#</a> setCellValue</h3> <p><em>setCellValue(row, column, value, [options])</em></p> <p>设置某个单元格的值，也可以设置整个单元格对象，用于同时设置多个单元格属性。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>row</td> <td>number</td> <td>行index</td></tr> <tr><td>column</td> <td>number</td> <td>列index</td></tr> <tr><td>value</td> <td>any</td> <td>要设置的值</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">可选参数</a> &amp; { type: string }</td> <td><code>type</code>: 单元格属性，默认是'v'</td></tr></tbody></table> <p>如果需要更新公式，也可以在这里赋值，fortune-sheet在内部会主动把这个公式做计算并加入到公式链中，最后重刷计算。</p> <ul><li><p><strong>示例</strong>:</p> <ul><li><p>设置当前工作表&quot;A1&quot;单元格的值为&quot;1&quot;    <code>workbookRef.current.setCellValue(0, 0, 1);</code></p></li> <li><p>设置当前工作表&quot;B1&quot;单元格的值为公式&quot;=sum(A1)&quot;    <code>workbookRef.current.setCellValue(0, 1, &quot;=sum(A1)&quot;);</code></p></li> <li><p>设置当前工作表&quot;C1&quot;单元格的值为公式&quot;=sum(A1:B1)&quot;，并带有红色背景，单元格对象可以不带<code>v</code>和<code>m</code>值，fortune-sheet会根据公式信息自动计算结果，如果带了未更新或者是非公式结果的<code>v</code>和<code>m</code>值，fortune-sheet也仍然会根据公式实际关联的数据计算出准备的结果。    <code>workbookRef.current.setCellValue(0, 2, {f: &quot;=sum(A1:B1)&quot;, bg:&quot;#FF0000&quot;})</code></p> <p>再次设置&quot;C1&quot;单元格新的公式仍然可以生效</p> <p><code>worksheetRef.current.setCellValue(0, 2, {f: &quot;=sum(A1)&quot;, bg:&quot;#00FF00&quot;})</code></p></li></ul></li></ul> <hr> <h3 id="clearcell"><a href="#clearcell" class="header-anchor">#</a> clearCell</h3> <p><em>clearCell(row, column, [options])</em></p> <p>清除指定工作表指定单元格的内容</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>row</td> <td>number</td> <td>行index</td></tr> <tr><td>column</td> <td>number</td> <td>列index</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <ul><li><p><strong>示例</strong>:</p> <ul><li>清空单元格<code>B2</code>内容 <code>workbookRef.current.clearCell(1,1)</code></li></ul></li></ul> <hr> <h3 id="setcellformat"><a href="#setcellformat" class="header-anchor">#</a> setCellFormat</h3> <p><em>setCellFormat(row, column, attr, value [,option])</em></p> <p>设置某个单元格的属性，如果要设置单元格的值或者同时设置多个单元格属性，推荐使用<code>setCellValue</code></p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>row</td> <td>number</td> <td>行index</td></tr> <tr><td>column</td> <td>number</td> <td>列index</td></tr> <tr><td>attr</td> <td>string, number, object</td> <td>属性类型，参考 <a href="/fortune-sheet-docs/zh/guide/cell.html">单元格属性表</a>的属性值</td></tr> <tr><td>value</td> <td>any</td> <td>对应属性要被设置的值</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <ul><li><p><strong>说明</strong>：</p> <p>特殊的设置</p> <p>边框设置时，attr为<code>&quot;bd&quot;</code>，value为一个key/value对象，需要同时设置边框类型:<code>borderType</code>/边框粗细:<code>style</code>/边框颜色:<code>color</code>，比如设置A1单元格的边框为所有/红色/细：</p> <p><code>luckysheet.setCellFormat(0, 0, &quot;bd&quot;, {borderType: &quot;border-right&quot;,style: &quot;1&quot;, color: &quot;#ff0000&quot;})</code></p> <p>完整可选的设置参数如下：</p> <ul><li>边框类型 borderType：&quot;border-left&quot; | &quot;border-right&quot; | &quot;border-top&quot; | &quot;border-bottom&quot; | &quot;border-all&quot; | &quot;border-outside&quot; | &quot;border-inside&quot; | &quot;border-horizontal&quot; | &quot;border-vertical&quot; | &quot;border-none&quot; | &quot;border-slash&quot;，</li> <li>边框粗细 style: 1 Thin | 2 Hair | 3 Dotted | 4 Dashed | 5 DashDot | 6 DashDotDot | <s>7 Double</s> | 8 Medium | 9 MediumDashed | 10 MediumDashDot | 11 MediumDashDotDot | <s>12 SlantedDashDot</s> | 13 Thick</li> <li>边框颜色 <code>color: 16进制颜色值</code></li></ul></li></ul> <hr> <h3 id="autofillcell"><a href="#autofillcell" class="header-anchor">#</a> autoFillCell</h3> <p><em>autoFillCell(copyRange, applyRange, direction)</em></p> <p>根据<code>copyRange</code>的内容自动填充<code>applyRange</code>的内容。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>copyRange</td> <td>{ row: number[], column: number[] }</td> <td>参考范围</td></tr> <tr><td>applyRange</td> <td>{ row: number[], column: number[] }</td> <td>目标范围</td></tr> <tr><td>direction</td> <td>&quot;up&quot;, &quot;down&quot;, &quot;left&quot;, &quot;right&quot;之一</td> <td>填充方向</td></tr></tbody></table> <hr> <h3 id="freeze"><a href="#freeze" class="header-anchor">#</a> freeze</h3> <p><em>freeze(type, range, [options])</em></p> <p>冻结行/列</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td>string</td> <td>&quot;row&quot;, &quot;column&quot;, &quot;both&quot; 之一</td></tr> <tr><td>range</td> <td>{ row: number, column: number }</td> <td><code>row</code>: 要冻结的 row index<br><code>column</code>: 要冻结的 column index</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="insertroworcolumn"><a href="#insertroworcolumn" class="header-anchor">#</a> insertRowOrColumn</h3> <p><em>insertRowOrColumn(type, index, count, direction, [options])</em></p> <p>在指定位置插入行/列</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td>string</td> <td>&quot;row&quot;或&quot;column&quot;</td></tr> <tr><td>index</td> <td>number</td> <td>插入位置的起始行或列的 index</td></tr> <tr><td>count</td> <td>number</td> <td>要插入的行或列的数量</td></tr> <tr><td>direction</td> <td>string</td> <td>'lefttop' or 'rightbottom' 之一，默认是 'rightbottom'.<br><code>lefttop</code>: 在 <code>index</code> 行上方或 <code>index</code> 列左侧插入行/列。<br><code>rightbottom</code>: 在 <code>index</code> 行下方或 <code>index</code> 列右侧插入行/列。</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="deleteroworcolumn"><a href="#deleteroworcolumn" class="header-anchor">#</a> deleteRowOrColumn</h3> <p><em>deleteRowOrColumn(type, start, end, [options])</em></p> <p>删除指定范围内的行/列</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td>string</td> <td>&quot;row&quot;或&quot;column&quot;</td></tr> <tr><td>start</td> <td>number</td> <td>要删除位置的起始行/列</td></tr> <tr><td>end</td> <td>number</td> <td>要删除位置的结束行/列</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="getrowheight"><a href="#getrowheight" class="header-anchor">#</a> getRowHeight</h3> <p><em>getRowHeight(rows, [options])</em></p> <p>获取一组行高</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>rows</td> <td>number[]</td> <td>一组行 indexe, 如 [1, 4]</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <p><strong>Returns</strong> 一组行高map { &quot;1&quot;: 150, &quot;4&quot;: 200 }。</p> <hr> <h3 id="getcolumnwidth"><a href="#getcolumnwidth" class="header-anchor">#</a> getColumnWidth</h3> <p><em>getColumnWidth(columns, [options])</em></p> <p>获取一组列宽</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>columns</td> <td>number[]</td> <td>一组列 indexe, 如 [1, 4]</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <p><strong>Returns</strong> 一组列宽map { &quot;1&quot;: 150, &quot;4&quot;: 200 }。</p> <hr> <h3 id="setrowheight"><a href="#setrowheight" class="header-anchor">#</a> setRowHeight</h3> <p><em>setRowHeight(rowInfo, [options])</em></p> <p>设置一组行高</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>rowInfo</td> <td>object</td> <td>一组列宽map，[row index]: height.<br>例如: { &quot;1&quot;: 150, &quot;4&quot;: 200 } 表示将第二行的行高设置为150，第五行的行高设置为200</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="setcolumnwidth"><a href="#setcolumnwidth" class="header-anchor">#</a> setColumnWidth</h3> <p><em>setColumnWidth(columnInfo, [options])</em></p> <p>设置一组列宽</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>columnInfo</td> <td>object</td> <td>一组列宽map，[column index]: width.<br>例如: { &quot;1&quot;: 150, &quot;4&quot;: 200 } 表示将第二列的列宽设置为150，第五行的行高设置为200</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="getselection"><a href="#getselection" class="header-anchor">#</a> getSelection</h3> <p><em>getSelection()</em></p> <p>获取当前选区</p> <p><strong>Returns</strong> 当前选区的列表。</p> <hr> <h3 id="setselection"><a href="#setselection" class="header-anchor">#</a> setSelection</h3> <p><em>setSelection(range, [options])</em></p> <p>设置选区</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>range</td> <td>{ row: number[], column: number[] }</td> <td>选区列表</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="getflattenrange"><a href="#getflattenrange" class="header-anchor">#</a> getFlattenRange</h3> <p><em>getFlattenRange(range)</em></p> <p>将给定的范围转化为单元格坐标</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>range</td> <td>{ row: number[], column: number[] }</td> <td>一个范围对象</td></tr></tbody></table> <p><strong>Returns</strong> 一组单元格坐标列表。</p> <ul><li><p><strong>示例</strong>:</p> <p>输入:</p> <div class="language- extra-class"><pre class="language-text"><code>{&quot;row&quot;: [0, 1], &quot;column&quot;: [0, 2]}
</code></pre></div><p>输出:</p> <div class="language- extra-class"><pre class="language-text"><code>[
  {&quot;r&quot;: 0, &quot;c&quot;: 0},
  {&quot;r&quot;: 0, &quot;c&quot;: 1},
  {&quot;r&quot;: 0, &quot;c&quot;: 2},
  {&quot;r&quot;: 1, &quot;c&quot;: 0},
  {&quot;r&quot;: 1, &quot;c&quot;: 1},
  {&quot;r&quot;: 1, &quot;c&quot;: 2},
]
</code></pre></div></li></ul> <hr> <h3 id="getcellsbyflattenrange"><a href="#getcellsbyflattenrange" class="header-anchor">#</a> getCellsByFlattenRange</h3> <p><em>getCellsByFlattenRange(range)</em></p> <p>将一组单元格坐标转换为选区范围数组</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>range</td> <td>{ r: number, c: number }[]</td> <td>一组单元格坐标</td></tr></tbody></table> <p><strong>Returns</strong> 根据单元格坐标转换的选区范围数组。</p> <hr> <h3 id="getselectioncoordinates"><a href="#getselectioncoordinates" class="header-anchor">#</a> getSelectionCoordinates</h3> <p><em>getSelectionCoordinates()</em></p> <p>获取选区单元格标识</p> <p>样例输出：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span><span class="token string">&quot;E10:E14&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;A7:B13&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;A3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;C6:D9&quot;</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="getcellsbyrange"><a href="#getcellsbyrange" class="header-anchor">#</a> getCellsByRange</h3> <p><em>getCellsByRange(range, [options])</em></p> <p>将选取数组转化为单元格对象</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>range</td> <td>{ row: number[], column: number[] }[]</td> <td>一组选区数组</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <p><strong>Returns</strong> 指定范围内的单元格对象。</p> <hr> <h3 id="gethtmlbyrange"><a href="#gethtmlbyrange" class="header-anchor">#</a> getHtmlByRange</h3> <p><em>getHtmlByRange(range, [options])</em></p> <p>获取制定选区的html形式的数据，通常是用于粘贴进Excel应用</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>range</td> <td>{ row: number[], column: number[] }[]</td> <td>一组选区数组</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <p><strong>Returns</strong> HTML字符串。</p> <hr> <h3 id="setcellvaluesbyrange"><a href="#setcellvaluesbyrange" class="header-anchor">#</a> setCellValuesByRange</h3> <p><em>setCellValuesByRange(data, range, [options])</em></p> <p>类似 <code>setCellValue</code>, 但是可以一次性设置多个单元格值</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>data</td> <td>any[][]</td> <td>表示单元格值的二维数组</td></tr> <tr><td>range</td> <td>{ row: number[], column: number[] }</td> <td>要设置的单元格范围</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <p><strong>Note</strong>: <code>data</code> 和 <code>range</code> 的大小必须相同。</p> <hr> <h3 id="setcellformatbyrange"><a href="#setcellformatbyrange" class="header-anchor">#</a> setCellFormatByRange</h3> <p><em>setCellFormatByRange(attr, value, range, [options])</em></p> <p>类似 <code>setCellFormat</code>, 但是可以一次性设置多个单元格格式</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>attr</td> <td>string</td> <td>单元格属性</td></tr> <tr><td>value</td> <td>any</td> <td>要设置的单元格 <code>attr</code></td></tr> <tr><td>range</td> <td>{ row: number[], column: number[] }</td> <td>要设置的单元格范围</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="mergecells"><a href="#mergecells" class="header-anchor">#</a> mergeCells</h3> <p><em>mergeCells(ranges, type, [options])</em></p> <p>根据ranges和type合并单元格</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>ranges</td> <td>{ row: number[], column: number[] }[]</td> <td>一组将要合并的单元格的列表</td></tr> <tr><td>type</td> <td>string</td> <td>&quot;merge-all&quot;, &quot;merge-horizontal&quot;, &quot;merge-vertical&quot; 之一</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="cancelmerge"><a href="#cancelmerge" class="header-anchor">#</a> cancelMerge</h3> <p><em>cancelMerge(ranges, [options])</em></p> <p>取消一个范围的合并单元格</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>ranges</td> <td>{ row: number[], column: number[] }[]</td> <td>一组要取消合的单元格范围</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="getallsheets"><a href="#getallsheets" class="header-anchor">#</a> getAllSheets</h3> <p><em>getAllSheets()</em></p> <p><strong>Returns</strong> 所有表的原始数据，表内数据为<code>data</code>形式。</p> <hr> <h3 id="getsheet"><a href="#getsheet" class="header-anchor">#</a> getSheet</h3> <p><em>getSheet(options)</em></p> <p>获取一张表的初始数据</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <p><strong>Returns</strong> 指定表的原始数据，表内数据为<code>data</code>形式。</p> <hr> <h3 id="addsheet"><a href="#addsheet" class="header-anchor">#</a> addSheet</h3> <p><em>addSheet()</em></p> <p>向workbook内新增一张表。</p> <hr> <h3 id="deletesheet"><a href="#deletesheet" class="header-anchor">#</a> deleteSheet</h3> <p><em>deleteSheet(options)</em></p> <p>删除指定表。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="updatesheet"><a href="#updatesheet" class="header-anchor">#</a> updateSheet</h3> <p><em>updateSheet(sheet[])</em></p> <p>使用指定数据生成表</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>sheet</td> <td><a href="/fortune-sheet-docs/zh/guide/sheet.html">Sheet</a>[]</td> <td>表格信息数组</td></tr></tbody></table> <p>你可以使用 <code>celldata</code> 或 <code>data</code> 来声明表格数据, 推荐使用 <code>celldata</code>。</p> <hr> <h3 id="activatesheet"><a href="#activatesheet" class="header-anchor">#</a> activateSheet</h3> <p><em>activateSheet(options)</em></p> <p>更改当前的工作表。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="setsheetname"><a href="#setsheetname" class="header-anchor">#</a> setSheetName</h3> <p><em>setSheetName(name, options)</em></p> <p>设置指定表的表名。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>name</td> <td>string</td> <td>要设置的表名</td></tr> <tr><td>[options]</td> <td><a href="#commonoptions">CommonOptions</a></td> <td>通用参数</td></tr></tbody></table> <hr> <h3 id="setsheetorder"><a href="#setsheetorder" class="header-anchor">#</a> setSheetOrder</h3> <p><em>setSheetOrder(orderList)</em></p> <p>设置表顺序。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>orderList</td> <td>object</td> <td>一个map，键: sheet id, 值: order number</td></tr></tbody></table> <p>样例输入:</p> <div class="language-json extra-class"><pre class="language-json"><code>
<span class="token punctuation">{</span>
	<span class="token property">&quot;id_of_sheet_1&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token property">&quot;id_of_sheet_2&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token property">&quot;id_of_sheet_3&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <h3 id="scroll"><a href="#scroll" class="header-anchor">#</a> scroll</h3> <p><em>scroll(options)</em></p> <p>将当前表滚动到指定位置。</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>options</td> <td>{ scrollLeft?: number, scrollTop?: number, targetRow?: number, targetColumn?: number }</td> <td>需要滚动到的位置，所有参数都是可选的</td></tr></tbody></table> <hr> <h3 id="addpresence"><a href="#addpresence" class="header-anchor">#</a> addPresence</h3> <p><em>addPresence(presence)</em></p> <p>添加协作者状态，将显示协作者聚焦的单元格</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>presence</td> <td>Presence</td> <td>一个 <code>Presence</code> 对象</td></tr></tbody></table> <p><code>Presence</code> 对象:</p> <table><thead><tr><th>属性</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>sheetId</td> <td>string</td> <td>表id</td></tr> <tr><td>username</td> <td>string</td> <td>需要再表格上展示的用户名</td></tr> <tr><td>userId</td> <td>string</td> <td>(可选) 用户标识，如果未设置则使用 <code>username</code></td></tr> <tr><td>color</td> <td>string</td> <td>聚焦框颜色</td></tr> <tr><td>selection</td> <td>{ r: number, c: number }</td> <td>聚焦框位置</td></tr></tbody></table> <hr> <h3 id="removepresence"><a href="#removepresence" class="header-anchor">#</a> removePresence</h3> <p><em>removePresence(presence)</em></p> <p>移除协作者状态</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>presence</td> <td>Presence</td> <td>一个 <code>Presence</code> 对象, 详见 <a href="#addpresence">addPresence</a>, 但是只需 <code>username</code> 或 <code>userId</code></td></tr></tbody></table> <hr> <h3 id="undo"><a href="#undo" class="header-anchor">#</a> undo</h3> <p><em>undo()</em></p> <p>撤销上一步</p> <hr> <h3 id="redo"><a href="#redo" class="header-anchor">#</a> redo</h3> <p><em>redo()</em></p> <p>重做上一步</p> <p>---​</p> <p>使用例子请查看 <a href="https://github.com/ruilisi/fortune-sheet/blob/master/stories/Collabration.stories.tsx" target="_blank" rel="noopener noreferrer">Collabration demo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <hr> <p>更多 API 敬请期待。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ruilisi/fortune-sheet/edit/master/docs/zh/guide/api.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/1/10 10:13:10</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/fortune-sheet-docs/zh/guide/op.html" class="prev">
        操作
      </a></span> <span class="next"><a href="/fortune-sheet-docs/zh/guide/FAQ.html">
        常见问题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/fortune-sheet-docs/assets/js/app.74366edf.js" defer></script><script src="/fortune-sheet-docs/assets/js/2.173094f5.js" defer></script><script src="/fortune-sheet-docs/assets/js/1.c7831255.js" defer></script><script src="/fortune-sheet-docs/assets/js/34.2f924603.js" defer></script>
  </body>
</html>
